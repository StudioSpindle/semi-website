---
layout: search
title: SeMI, Collaborative Knowledge Network
---

<article>
	<section>
		<h1>Search</h1>
		<div class="noSearch" style="display:none">Please add a query to the url: <code>url/?query=knowledge</code></div>
	</section>

	<!-- searchbox will be copied to show content-->
	<div class="searchBox" style="display: none">
		<div class="title"></div>
		<div class="resultHTML">Result</div>
	</div>

</article>

<script>
'use strict';

// Set global variables
var searchBox 			= document.getElementsByClassName("searchBox")[0],
	articleSectionName 	= "article",
	GoogleApiKey 		= "AIzaSyCV4SC6uTz7bzYu1TmM_3iq2smlvbJOVLg",
	GoogleSearchId 		= "008702682383656025817:4lkjxykfngo";

// get the query param by name
function getParameterByName(name) {
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)");
    var results = regex.exec(window.location.href);
    if (!results){
		return null;
	}
    if (!results[2]){
		return "";
	}
    return decodeURIComponent(results[2].replace("/\+/g", " "));
}

// Load the results via Google API
function loadResults(i) {
	var xhttp = new XMLHttpRequest();
	xhttp.onreadystatechange = function() {
		// if status = 4 or 200 exec.
		if (this.readyState == 4 && this.status == 200) {
			// declare newbox and the result
			var newBox,
				JSONresult = JSON.parse(this.responseText);
			
			// load JSON
			JSON
				// parse JSON
				.parse(this.responseText)
				// find items
				.items
				// loop over items
				.forEach(function(element) {
					// clone the searchbox;
					newBox = searchBox.cloneNode(true);
					// remove display = none
					newBox.style.display = "block";
					// Set the title with URL
					newBox
						.getElementsByClassName("title")[0]
						.innerHTML = "<a href=\"" + element.link + "\" target=\"_self\">" + element.htmlTitle + "</a>";
					// set the inner HTML snippet
					newBox.getElementsByClassName("resultHTML")[0]
						.innerHTML = element.htmlSnippet;
					// append the box to the article
					document.getElementsByTagName(articleSectionName)[0].appendChild(newBox);
				});

		}
	};
	// open the URL
	xhttp
		.open("GET", "https://www.googleapis.com/customsearch/v1?key=" + GoogleApiKey + "&cx= " + GoogleSearchId + "&q=" + i, true);
	// send the request
	xhttp
		.send();
}

// when loading is ready add
document
	.addEventListener('DOMContentLoaded', function(){ 
		var queryString = getParameterByName("query");
		if(queryString != null && queryString != ""){
			// query is available in querystring so load the results
			loadResults(queryString);
		}
	}, false);

</script>